function plotspecSmoothed(ES,cropX,cropY,scal_f)

StepsX = ((abs(ES.stim_centre_pos(1)-ES.stim_dims(1)/2)+abs(ES.stim_centre_pos(1)+ES.stim_dims(1)/2))/4);
XTickLabels = min(ES.stim_centre_pos(1)-ES.stim_dims(1)/2,ES.stim_centre_pos(1)+ES.stim_dims(1)/2):StepsX: ...
                max(ES.stim_centre_pos(1)-ES.stim_dims(1)/2,ES.stim_centre_pos(1)+ES.stim_dims(1)/2);
StepsY = ((abs(ES.stim_centre_pos(2)-ES.stim_dims(2)/2)+abs(ES.stim_centre_pos(2)+ES.stim_dims(2)/2))/4);
YTickLabels = min(ES.stim_centre_pos(2)-ES.stim_dims(2)/2,ES.stim_centre_pos(2)+ES.stim_dims(2)/2):StepsY: ...
                max(ES.stim_centre_pos(2)-ES.stim_dims(2)/2,ES.stim_centre_pos(2)+ES.stim_dims(2)/2);
set(gca,...
    'ylim',[0 length(cropX)*scal_f+0.5],...
    'YTick',[0:length(cropX)*scal_f*0.25:length(cropX)*scal_f],...
    'YTickLabel',sort(YTickLabels,'descend'),...
    'xlim',[0 length(cropX)*scal_f],...
    'XTick',[0:length(cropX)*scal_f*0.25:length(cropX)*scal_f],...
    'XTickLabel',XTickLabels)
xlabel('Azimuth (^o)');
ylabel('Elevation (^o)');
set(gca,'FontSize',13,'TickDir','out','FontName','Arial');
grid on
end